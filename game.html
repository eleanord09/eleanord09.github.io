<!DOCTYPE html>
<html>
<head>
  <title>Endless Branch Jumper</title>
  <style>
    canvas {
      border: 1px solid black;
      background-color: #e0f7fa;
      display: block;
      margin: auto;
    }
    body {
      text-align: center;
      font-family: Arial;
    }
  </style>
</head>
<body>
  <h2>Endless Branch Jumper</h2>
  <p>Press <strong>Spacebar</strong> to jump. Don't fall!</p>
  <canvas id="gameCanvas" width="400" height="500"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const player = {
      x: 200,
      y: 400,
      radius: 15,
      color: "green",
      vy: 0,
      gravity: 0.5,
      jumpPower: -10,
      onGround: false
    };

    let branches = [
      { x: 150, y: 450, width: 100, height: 10 }
    ];

    let score = 0;
    let gameOver = false;
    const branchInterval = 100;
    const scrollSpeed = 1;
    let lastBranchY = 450;
    let lastBranchX = 150;
    const maxHorizontalGap = 100; // maximum horizontal distance between branches

    document.addEventListener("keydown", (e) => {
      if (e.code === "Space" && player.onGround && !gameOver) {
        player.vy = player.jumpPower;
        player.onGround = false;
      }
    });

    function drawPlayer() {
      ctx.fillStyle = player.color;
      ctx.beginPath();
      ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawBranches() {
      ctx.fillStyle = "brown";
      branches.forEach(branch => {
        ctx.fillRect(branch.x, branch.y, branch.width, branch.height);
      });
    }

    function checkCollision(branch) {
      return (
        player.y + player.radius >= branch.y &&
        player.y + player.radius <= branch.y + branch.height &&
        player.x + player.radius > branch.x &&
        player.x - player.radius < branch.x + branch.width &&
        player.vy >= 0
      );
    }

    function updateBranches() {
      branches.forEach(branch => {
        branch.y += scrollSpeed;
      });

      // Add new branches within reachable distance
      while (lastBranchY > 0) {
        const width = Math.random() * 60 + 60;
        let x = lastBranchX + (Math.random() * 2 - 1) * maxHorizontalGap;
        x = Math.max(0, Math.min(canvas.width - width, x)); // keep within canvas
        const newY = lastBranchY - branchInterval;
        branches.push({ x: x, y: newY, width: width, height: 10 });
        lastBranchY = newY;
        lastBranchX = x;
      }

      // Remove branches off-screen
      branches = branches.filter(branch => branch.y < canvas.height + 20);
    }

    function drawScore() {
      ctx.fillStyle = "black";
      ctx.font = "16px Arial";
      ctx.fillText("Score: " + score, 10, 20);
    }

    function drawGameOver() {
      ctx.fillStyle = "red";
      ctx.font = "24px Arial";
      ctx.fillText("Game Over", 130, 250);
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      updateBranches();

      player.vy += player.gravity;
      player.y += player.vy;

      player.onGround = false;
      for (const branch of branches) {
        if (checkCollision(branch)) {
          player.y = branch.y - player.radius;
          player.vy = 0;
          player.onGround = true;
          score++;
          break;
        }
      }

      if (player.y > canvas.height) {
        gameOver = true;
      }

      drawBranches();
      drawPlayer();
      drawScore();

      if (gameOver) {
        drawGameOver();
      } else {
        requestAnimationFrame(draw);
      }
    }

    draw();
  </script>
</body>
</html>


